{
  "hash": "eb55381afa11bc60b4dd145ef9229168",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Problem set 5\"\nauthor: \"Put your name here\"\nformat: \n  html:\n    toc: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(broom)\n```\n:::\n\n\n\nRead the survey data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the survey data from class\npenguins <- read_csv(\"../data/penguins.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 342 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): species, island, sex\ndbl (5): bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n### Graphs\n\nWhat is the relationship between penguin weight and bill depth? This plot shows some initial trends:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, \n       aes(x = bill_depth_mm, y = body_mass_g)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](05-solution_files/figure-html/plot-penguin-weight-depth-1.png){width=672}\n:::\n:::\n\n\n\nMake a new plot that colors these points by species. What can you tell about the relationship between bill depth and penguin weight?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, \n       aes(x = bill_depth_mm, y = body_mass_g, color = species)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](05-solution_files/figure-html/plot-penguin-weight-depth-by-species-1.png){width=672}\n:::\n:::\n\n\n\n> It seems like the longer the bill, the greater the body mass, but only within species. If we ignore the species it looks like greater bill depth is associated with lower body mass.\n\nAdd a `geom_smooth()` layer to the plot and make sure it uses a straight line (hint: include `method=\"lm\"` in the function). What does this tell you about the relationship between bill depth and body mass?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, \n       aes(x = bill_depth_mm, y = body_mass_g, color = species)) +\n  geom_smooth(method = \"lm\") +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](05-solution_files/figure-html/plot-penguin-weight-depth-by-species-with-lines-1.png){width=672}\n:::\n:::\n\n\n\n> This confirms that within different species, there is a positive relationship. \n\nChange the plot so that there's a single line for all the points instead of one line per species. How does the slope of this single line differ from the slopes of the species specific lines? ***Why??***\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, \n       aes(x = bill_depth_mm, y = body_mass_g)) +\n  geom_smooth(method = \"lm\") +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](05-solution_files/figure-html/plot-penguin-weight-depth-by-species-with-one-line-1.png){width=672}\n:::\n:::\n\n\n\n> By removing the color layer, geom_smooth only draws one line considering all of the data. Glancing over species, there is actually a negative association between bill depth and body mass in the data. \n\nWhat is the relationship between flipper length and body mass? Make another plot with `flipper_length_mm` on the x-axis, `body_mass_g` on the y-axis, and points colored by `species`. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, \n       aes(x = flipper_length_mm, y = body_mass_g, color = species)) +\n  geom_smooth(method = \"lm\") +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](05-solution_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n> There is a positive relationship between flipper length and body mass, both within and across species.\n\nFacet (`facet_wrap`) the plot by island (`island`). What does this graph tell you ?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins,\n       aes(x = flipper_length_mm, y = body_mass_g, color = species)) +\n  geom_point() +\n  facet_wrap(vars(island))\n```\n\n::: {.cell-output-display}\n![](05-solution_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n> There is a positive relationship between flipper length and body mass, for all species. However, not all species are present on all islands. Of the Gentoo, the penguins with the smalles flipper length still have flipper lengths of the size as the biggest once of the Chinstrap and Adelie.\n\n\n### Regression\n\nDoes bill depth predict penguin weight? Run a linear regression (`lm()`) and interpret the estimate and the p.value. Interpret the result in light of previous plots that you have generated. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_depth_weight <- lm(body_mass_g ~ bill_depth_mm,\n                         data = penguins)\n\ntidy(model_depth_weight)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term          estimate std.error statistic  p.value\n  <chr>            <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)      7489.     335.      22.3  1.13e-68\n2 bill_depth_mm    -192.      19.4     -9.87 2.28e-20\n```\n\n\n:::\n:::\n\n\n\n> Yes, bill depth does predict penguin weight, negatively. A one mm increase in bill depth is associated with approximately 191 gramms less body weight. However, as we saw earlier in the plots, this is only true when comparing across species. Within species the opposite is true. This result is statistically significant, as indicated by the low p-value (smaller than 0.05).\n\nRun different regression analyses for the different species (use `filter()`) to subset the data frame. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# check different species\ntable(penguins$species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   Adelie Chinstrap    Gentoo \n      151        68       123 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nregression_adelie <- lm(body_mass_g ~ bill_depth_mm, \n                        data = penguins |> \n                          filter(species == \"Adelie\")) \n\nregression_chinstrap <- lm(body_mass_g ~ bill_depth_mm, \n                        data = penguins |> \n                          filter(species == \"Chinstrap\"))\n\nregression_gentoo <- lm(body_mass_g ~ bill_depth_mm, \n                        data = penguins |> \n                          filter(species == \"Gentoo\"))\n\n# we can use the modelsummary package to display the results of all three regressions at once\nmodelsummary::modelsummary(list(\"Adelie\" = regression_adelie, \n                  \"Chinstrap\" = regression_chinstrap, \n                  \"Gentoo\" = regression_gentoo), \n                  statistic = \"p.value\", \n                  stars = TRUE)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_czps5uwja06v4zhu84y2(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_czps5uwja06v4zhu84y2\");\n          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_czps5uwja06v4zhu84y2');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_czps5uwja06v4zhu84y2(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_czps5uwja06v4zhu84y2\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: 11, j: 2 }, { i: 11, j: 1 }, { i: 11, j: 3 },  ], css_id: 'tinytable_css_f08d4n2lhiw85mh6funo',}, \n          { positions: [ { i: 4, j: 3 }, { i: 4, j: 2 }, { i: 4, j: 1 },  ], css_id: 'tinytable_css_77h9ngmed2i832h28gcr',}, \n          { positions: [ { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 5, j: 1 }, { i: 6, j: 1 }, { i: 3, j: 1 }, { i: 5, j: 2 }, { i: 9, j: 1 }, { i: 10, j: 1 }, { i: 7, j: 1 }, { i: 8, j: 1 }, { i: 1, j: 2 }, { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 5, j: 3 }, { i: 6, j: 3 }, { i: 6, j: 2 }, { i: 7, j: 2 }, { i: 8, j: 2 }, { i: 9, j: 2 }, { i: 10, j: 2 }, { i: 3, j: 3 }, { i: 8, j: 3 }, { i: 1, j: 3 }, { i: 2, j: 3 }, { i: 7, j: 3 }, { i: 9, j: 3 }, { i: 10, j: 3 },  ], css_id: 'tinytable_css_rbo27u8ndtdyrhskb1nk',}, \n          { positions: [ { i: 0, j: 1 }, { i: 0, j: 3 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_ihp3kg4h4goks29xs2n8',}, \n          { positions: [ { i: 11, j: 0 },  ], css_id: 'tinytable_css_ba1ok9a2xsz6rfhgta3c',}, \n          { positions: [ { i: 4, j: 0 },  ], css_id: 'tinytable_css_5fp1yr7b7pr63hvjpezk',}, \n          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 8, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 },  ], css_id: 'tinytable_css_qbqmu76f6m11qbwi28z2',}, \n          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_b4wa1y9vvepglhggdyri',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_czps5uwja06v4zhu84y2(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_f08d4n2lhiw85mh6funo, .table th.tinytable_css_f08d4n2lhiw85mh6funo { text-align: center; border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_77h9ngmed2i832h28gcr, .table th.tinytable_css_77h9ngmed2i832h28gcr { text-align: center; border-bottom: solid black 0.05em; }\n      .table td.tinytable_css_rbo27u8ndtdyrhskb1nk, .table th.tinytable_css_rbo27u8ndtdyrhskb1nk { text-align: center; }\n      .table td.tinytable_css_ihp3kg4h4goks29xs2n8, .table th.tinytable_css_ihp3kg4h4goks29xs2n8 { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n      .table td.tinytable_css_ba1ok9a2xsz6rfhgta3c, .table th.tinytable_css_ba1ok9a2xsz6rfhgta3c { text-align: left; border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_5fp1yr7b7pr63hvjpezk, .table th.tinytable_css_5fp1yr7b7pr63hvjpezk { text-align: left; border-bottom: solid black 0.05em; }\n      .table td.tinytable_css_qbqmu76f6m11qbwi28z2, .table th.tinytable_css_qbqmu76f6m11qbwi28z2 { text-align: left; }\n      .table td.tinytable_css_b4wa1y9vvepglhggdyri, .table th.tinytable_css_b4wa1y9vvepglhggdyri { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_czps5uwja06v4zhu84y2\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">Adelie</th>\n                <th scope=\"col\">Chinstrap</th>\n                <th scope=\"col\">Gentoo</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='4'>+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>-283.279</td>\n                  <td>-36.219</td>\n                  <td>-458.985</td>\n                </tr>\n                <tr>\n                  <td></td>\n                  <td>(0.542)</td>\n                  <td>(0.953)</td>\n                  <td>(0.348)</td>\n                </tr>\n                <tr>\n                  <td>bill_depth_mm</td>\n                  <td>217.152***</td>\n                  <td>204.625***</td>\n                  <td>369.441***</td>\n                </tr>\n                <tr>\n                  <td></td>\n                  <td>(<0.001)</td>\n                  <td>(<0.001)</td>\n                  <td>(<0.001)</td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.</td>\n                  <td>151</td>\n                  <td>68</td>\n                  <td>123</td>\n                </tr>\n                <tr>\n                  <td>R2</td>\n                  <td>0.332</td>\n                  <td>0.365</td>\n                  <td>0.517</td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.</td>\n                  <td>0.327</td>\n                  <td>0.356</td>\n                  <td>0.513</td>\n                </tr>\n                <tr>\n                  <td>AIC</td>\n                  <td>2223.3</td>\n                  <td>976.4</td>\n                  <td>1795.3</td>\n                </tr>\n                <tr>\n                  <td>BIC</td>\n                  <td>2232.3</td>\n                  <td>983.1</td>\n                  <td>1803.8</td>\n                </tr>\n                <tr>\n                  <td>Log.Lik.</td>\n                  <td>-1108.647</td>\n                  <td>-485.224</td>\n                  <td>-894.666</td>\n                </tr>\n                <tr>\n                  <td>RMSE</td>\n                  <td>373.57</td>\n                  <td>303.90</td>\n                  <td>348.89</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n> As observered earlier in the plots, we find a positive association between bill depth and body mass for all species when analyzed seperately. These results are statistically significant, as indicated by the low p-values (smaller than 0.05).\n\n",
    "supporting": [
      "05-solution_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}